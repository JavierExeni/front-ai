<div class="card card-border border-base-300 grid grid-cols-2 overflow-hidden">
  <div class="bg-base-200 p-8 flex flex-col">
    <!-- Header -->
    <div class="mb-6">
      <p class="text-sm text-base-content/60 mb-2">4/4</p>
      <h2 class="text-2xl font-bold mb-2">Invite Team</h2>
      <p class="text-sm text-base-content/70">Invite your team to collaborate together.</p>
    </div>

    <!-- Team Members List -->
    <div class="flex-1 overflow-y-auto">
      <h3 class="text-sm font-semibold mb-4">Send Invites</h3>



      <!-- Add Member Form -->
      <form [formGroup]="inviteForm" (ngSubmit)="addTeamMember()" class="flex gap-2">
        <div class="flex-1">
          <input pInputText id="email" formControlName="email" placeholder="Enter email address" pSize="small"
            class="w-full" [class.ng-invalid]="inviteForm.get('email')?.invalid && inviteForm.get('email')?.touched" />
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Add</button>
      </form>

      <!-- Added Members -->
      <div class="flex flex-col gap-3 mt-4">
        @for (member of teamMembers(); track member.email) {
        <div class="flex items-center gap-3 bg-base-100 p-3 rounded-lg">
          <!-- Avatar -->
          <div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center text-primary font-semibold">
            {{ getInitial(member.email) }}
          </div>

          <!-- Email -->
          <div class="flex-1 min-w-0">
            <p class="text-sm truncate">{{ member.email }}</p>
          </div>

          <!-- Role Selector -->
          <select
            class="select select-bordered select-sm w-28"
            [value]="member.is_company_admin ? 'admin' : 'user'"
            (change)="updateMemberRole(member.email, $event)"
            [attr.aria-label]="'Select role for ' + member.email">
            <option value="user">User</option>
            <option value="admin">Admin</option>
          </select>

          <!-- Remove Button -->
          <button type="button" (click)="removeTeamMember(member.email)" class="btn btn-error btn-sm btn-square"
            [attr.aria-label]="'Remove ' + member.email">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        }
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-col gap-3 mt-6">

      <button type="button" (click)="onContinue()" class="btn btn-primary" [disabled]="isLoading()">
        @if (isLoading()) {
        <span class="loading loading-spinner loading-sm"></span>
        Registering...
        } @else {
        Continue
        }
      </button>
      <div class="grid grid-cols-[auto_1fr] items-center justify-between gap-3">
        <button (click)="activateStep.emit(3)" type="button" class="btn btn-neutral" [disabled]="isLoading()">
          <i class="fa-solid fa-arrow-left pt-0.5"></i>
          <span class="text-sm">
            Back
          </span>
        </button>
        <button type="button" (click)="onSkip()" class="btn btn-neutral w-full" [disabled]="isLoading()">
          @if (isLoading()) {
          <span class="loading loading-spinner loading-sm"></span>
          } @else {
          Skip for now
          }
        </button>
      </div>
    </div>
  </div>

  <div>
    <img src="images/onboarding/image-4.png" alt="step-4" class="w-full h-full object-cover" />
  </div>
</div>
